<?php 

    require($_SERVER['DOCUMENT_ROOT'].'/wp-load.php');
    $year = htmlspecialchars(trim($_POST['year']));

?>


<?php
	if( ($year == '')){
		$galleryImageArray = array( 'post_type' => 'gallery', 'numberposts' => -1, 'order' => 'ASC', 'tax_query' => array(
			array(
				'taxonomy' => 'gallery-category',
				'field' => 'id', 
				'terms' =>  9
			)));
		$galleryImage = get_posts( $galleryImageArray );

			foreach($galleryImage as $gallery){
                $galleryPhoto = get_field("gallery_images", $gallery->ID);
                $count = (count($galleryPhoto));
            ?>
                <div class="col-md-3 gallery_load">
                    <div class="photo_box__item">
                        <a href="<?php the_permalink($gallery->ID);?>">
                            <div class="photo_item__img">
                                <?php echo get_the_post_thumbnail( $gallery->ID, 'large'); ?>
                                <div class="photo_item__text">
                                    <p>
                                        <?php echo $gallery->post_title;?>
                                    </p>
                                </div>

                                <div class="photo_box__hover">
                                    <p><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <g clip-path="url(#clip0)">
                                                <path d="M11.1147 8.07071L11.1147 8.0708L10.8872 9.04135C4.53695 10.2406 0.720185 12.2246 0.531479 12.3279C0.130069 12.5382 -0.125 12.9578 -0.125 13.4141V26.4549C-0.125 31.7484 4.17941 36.0611 9.48124 36.0611C10.1654 36.0611 10.7135 35.513 10.7135 34.8289C10.7135 34.1447 10.1654 33.5966 9.48124 33.5966C5.54772 33.5966 2.33948 30.3964 2.33948 26.4549V14.1917C3.71344 13.5703 7.17764 12.1744 12.1188 11.3228C12.6034 11.2404 12.9954 10.8664 13.1051 10.3913C13.1052 10.3913 13.1052 10.3912 13.1052 10.3911L13.5151 8.62832C13.5152 8.62828 13.5152 8.62824 13.5152 8.6282C13.9121 6.94541 15.3876 5.76379 17.1253 5.76379H22.8747C24.6045 5.76379 26.0879 6.93757 26.4848 8.62799C26.4848 8.62806 26.4848 8.62813 26.4848 8.6282L26.8947 10.3906C26.8947 10.3908 26.8948 10.391 26.8948 10.3912C27.0047 10.8756 27.3977 11.2407 27.8815 11.3228L27.9024 11.1996L27.8811 11.3228C32.8064 12.1744 36.2784 13.5704 37.6605 14.1919V26.4549C37.6605 30.3884 34.4603 33.5966 30.5188 33.5966C29.8346 33.5966 29.2865 34.1447 29.2865 34.8289C29.2865 35.513 29.8346 36.0611 30.5188 36.0611C35.8122 36.0611 40.125 31.7567 40.125 26.4549V13.4141C40.125 12.9594 39.8794 12.5387 39.468 12.3276C39.2731 12.2212 35.4575 10.2477 29.1128 9.04145L28.8853 8.07098C28.2324 5.26688 25.7625 3.29932 22.8747 3.29932H17.1253C14.2457 3.29932 11.7759 5.25864 11.1147 8.07071Z"
                                                    stroke="#BFD7D3" stroke-width="0.25" />
                                                <path d="M7.06585 6.82133L7.06552 6.82141C5.75841 7.13379 4.46752 7.49556 3.23387 7.89855C2.58471 8.10893 2.23856 8.81195 2.44845 9.45073L2.44842 9.45074L2.44925 9.4531C2.63087 9.9707 3.11286 10.2995 3.62523 10.2995C3.75179 10.2995 3.88061 10.2814 4.01032 10.2353C5.17086 9.85121 6.38888 9.50789 7.63163 9.21354C8.29881 9.05806 8.69989 8.39108 8.54494 7.73454C8.38942 7.06737 7.7224 6.66631 7.06585 6.82133Z"
                                                    stroke="#BFD7D3" stroke-width="0.25" />
                                                <path d="M20.0041 10.9517C12.9061 10.9517 7.13354 16.7243 7.13354 23.8222C7.13354 30.92 12.906 36.7009 20.0041 36.7009C27.102 36.7009 32.8746 30.9283 32.8746 23.8304C32.8746 16.7326 27.1021 10.9517 20.0041 10.9517ZM20.0041 34.2365C14.2663 34.2365 9.59802 29.5682 9.59802 23.8304C9.59802 18.0925 14.2664 13.4161 20.0041 13.4161C25.7419 13.4161 30.4101 18.0844 30.4101 23.8222C30.4101 29.5601 25.7418 34.2365 20.0041 34.2365Z"
                                                    stroke="#BFD7D3" stroke-width="0.25" />
                                            </g>
                                            <defs>
                                                <clipPath id="clip0">
                                                    <rect width="40" height="40" fill="white" />
                                                </clipPath>
                                            </defs>
                                        </svg>
                                        <?php echo $count;?> фото</p>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
<?}?>



<?}else{
        $args = array(
            'tax_query' => array(
                array(
                    'taxonomy' => 'gallery-category',
                    'field'    => 'id',
                    'terms'    => 9
                )
            ),
            'post_type' => 'gallery',
            'posts_per_page' => -1,
            'year' => $year
        );
        $posts = new WP_Query ( $args );
		if( $posts->have_posts() ){ while( $posts->have_posts() ){ $posts->the_post(); 
        $post_id = get_the_ID();
        $galleryPhoto = get_field("gallery_images", $post_id);
         $count = (count($galleryPhoto));
		?>

<div class="col-md-3 gallery_load">
    <div class="photo_box__item">
        <a href="<?php the_permalink($post_id);?>">
            <div class="photo_item__img">
                <?php echo get_the_post_thumbnail( $post_id, 'large'); ?>
                <div class="photo_item__text">
                    <p>
                        <?php the_title();?>
                    </p>
                </div>

                <div class="photo_box__hover">
                    <p><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0)">
                                <path d="M11.1147 8.07071L11.1147 8.0708L10.8872 9.04135C4.53695 10.2406 0.720185 12.2246 0.531479 12.3279C0.130069 12.5382 -0.125 12.9578 -0.125 13.4141V26.4549C-0.125 31.7484 4.17941 36.0611 9.48124 36.0611C10.1654 36.0611 10.7135 35.513 10.7135 34.8289C10.7135 34.1447 10.1654 33.5966 9.48124 33.5966C5.54772 33.5966 2.33948 30.3964 2.33948 26.4549V14.1917C3.71344 13.5703 7.17764 12.1744 12.1188 11.3228C12.6034 11.2404 12.9954 10.8664 13.1051 10.3913C13.1052 10.3913 13.1052 10.3912 13.1052 10.3911L13.5151 8.62832C13.5152 8.62828 13.5152 8.62824 13.5152 8.6282C13.9121 6.94541 15.3876 5.76379 17.1253 5.76379H22.8747C24.6045 5.76379 26.0879 6.93757 26.4848 8.62799C26.4848 8.62806 26.4848 8.62813 26.4848 8.6282L26.8947 10.3906C26.8947 10.3908 26.8948 10.391 26.8948 10.3912C27.0047 10.8756 27.3977 11.2407 27.8815 11.3228L27.9024 11.1996L27.8811 11.3228C32.8064 12.1744 36.2784 13.5704 37.6605 14.1919V26.4549C37.6605 30.3884 34.4603 33.5966 30.5188 33.5966C29.8346 33.5966 29.2865 34.1447 29.2865 34.8289C29.2865 35.513 29.8346 36.0611 30.5188 36.0611C35.8122 36.0611 40.125 31.7567 40.125 26.4549V13.4141C40.125 12.9594 39.8794 12.5387 39.468 12.3276C39.2731 12.2212 35.4575 10.2477 29.1128 9.04145L28.8853 8.07098C28.2324 5.26688 25.7625 3.29932 22.8747 3.29932H17.1253C14.2457 3.29932 11.7759 5.25864 11.1147 8.07071Z"
                                    stroke="#BFD7D3" stroke-width="0.25" />
                                <path d="M7.06585 6.82133L7.06552 6.82141C5.75841 7.13379 4.46752 7.49556 3.23387 7.89855C2.58471 8.10893 2.23856 8.81195 2.44845 9.45073L2.44842 9.45074L2.44925 9.4531C2.63087 9.9707 3.11286 10.2995 3.62523 10.2995C3.75179 10.2995 3.88061 10.2814 4.01032 10.2353C5.17086 9.85121 6.38888 9.50789 7.63163 9.21354C8.29881 9.05806 8.69989 8.39108 8.54494 7.73454C8.38942 7.06737 7.7224 6.66631 7.06585 6.82133Z"
                                    stroke="#BFD7D3" stroke-width="0.25" />
                                <path d="M20.0041 10.9517C12.9061 10.9517 7.13354 16.7243 7.13354 23.8222C7.13354 30.92 12.906 36.7009 20.0041 36.7009C27.102 36.7009 32.8746 30.9283 32.8746 23.8304C32.8746 16.7326 27.1021 10.9517 20.0041 10.9517ZM20.0041 34.2365C14.2663 34.2365 9.59802 29.5682 9.59802 23.8304C9.59802 18.0925 14.2664 13.4161 20.0041 13.4161C25.7419 13.4161 30.4101 18.0844 30.4101 23.8222C30.4101 29.5601 25.7418 34.2365 20.0041 34.2365Z"
                                    stroke="#BFD7D3" stroke-width="0.25" />
                            </g>
                            <defs>
                                <clipPath id="clip0">
                                    <rect width="40" height="40" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                        <?php echo $count;?> фото</p>
                </div>
            </div>
        </a>
    </div>
</div>

<?php
		}}
		else // Если постов нет
			echo "<tr><td style='text-align: center; font-size: 15px; padding: 5px;'>Нічого не знайдено.</td></tr>";
    } 
?>